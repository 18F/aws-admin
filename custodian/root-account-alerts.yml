policies:

  - name: root-user-login-detected
    resource: account
    description: |
      Notifies Security and Cloud Admins teams on any AWS root user console logins
    mode:
       type: cloudtrail
       events:
          - ConsoleLogin
       role: arn:aws:iam::133032889584:role/cloudcustodian-cloudwatch-role
    filters:
       - type: event
         key: "detail.userIdentity.type"
         value_type: swap
         op: in
         value: Root
    actions:
      - type: notify
        slack_template: slack
        slack_msg_color: danger
        to: 
          - slack://webhook/#tts-tech-portfolio-alerts
        transport:
          type: sqs
          queue: https://sqs.us-east-1.amazonaws.com/133032889584/cloud-custodian-mailer
          region: us-east-1
